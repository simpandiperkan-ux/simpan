<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Data Kapal SIMPAN</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{font-family:Arial;background:#f4f6f8;padding:20px}
.box{max-width:900px;margin:auto;background:#fff;padding:24px;border-radius:14px;box-shadow:0 4px 20px rgba(0,0,0,.08)}
table{width:100%;border-collapse:collapse}
th,td{padding:10px;border-bottom:1px solid #eee;text-align:left}
th{width:35%;background:#f1f3f4}
img{max-width:160px;border-radius:8px}
</style>
</head>
<body>

<div class="box">
<h2>ðŸ“„ Data Kapal SIMPAN</h2>
<div id="hasil">Memuat...</div>
</div>

<script>
const URL="https://docs.google.com/spreadsheets/d/1G8fNMGPKo3QX8rm85ux8u8SC0m3SpwKMtzXWShOscZQ/gviz/tq?tqx=out:json";
const id=new URLSearchParams(location.search).get("id");
const hasil=document.getElementById("hasil");

function f(v){
 if(!v) return "-";
 if(typeof v==="string" && v.startsWith("Date")){
  const m=v.match(/\d+/g).map(Number);
  return new Date(m[0],m[1],m[2]).toLocaleDateString("id-ID");
 }
 if(v.startsWith?.("http")) return `<a href="${v}" target="_blank">Buka</a>`;
 return v;
}

fetch(URL).then(r=>r.text()).then(t=>{
 const j=JSON.parse(t.substring(47,t.length-2));
 const h=j.table.cols.map(c=>c.label);
 const rows=j.table.rows.map(r=>r.c.map(c=>c?.v??""));

 const idx=h.indexOf("ID SIMPAN");
 const row=rows.find(r=>r[idx]==id);

 if(!row){hasil.innerHTML="Data tidak ditemukan";return;}

 let html="<table>";
 h.forEach((k,i)=>html+=`<tr><th>${k}</th><td>${f(row[i])}</td></tr>`);
 html+="</table>";
 hasil.innerHTML=html;
});
</script>
</body>
</html>
